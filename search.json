[{"path":"https://igordot.github.io/phenomenalist/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 Igor Dolgalev Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://igordot.github.io/phenomenalist/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Igor Dolgalev. Author, maintainer.","code":""},{"path":"https://igordot.github.io/phenomenalist/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Dolgalev (2023). phenomenalist: Analysis Toolkit PhenoCycler (CODEX) Data R. R package version 0.0.0.9002, https://igordot.github.io/phenomenalist/.","code":"@Manual{,   title = {phenomenalist: Analysis Toolkit for PhenoCycler (CODEX) Data in R},   author = {Igor Dolgalev},   year = {2023},   note = {R package version 0.0.0.9002},   url = {https://igordot.github.io/phenomenalist/}, }"},{"path":[]},{"path":"https://igordot.github.io/phenomenalist/reference/clean_col_names.html","id":null,"dir":"Reference","previous_headings":"","what":"Clean up data frame column names — clean_col_names","title":"Clean up data frame column names — clean_col_names","text":"Clean data frame column names","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/clean_col_names.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Clean up data frame column names — clean_col_names","text":"","code":"clean_col_names(x)"},{"path":"https://igordot.github.io/phenomenalist/reference/clean_col_names.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Clean up data frame column names — clean_col_names","text":"x data frame.","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/clean_col_names.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Clean up data frame column names — clean_col_names","text":"data frame.","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/cluster.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform clustering — cluster","title":"Perform clustering — cluster","text":"Cluster similar cells based expression profiles.","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/cluster.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform clustering — cluster","text":"","code":"cluster(   x,   method = c(\"leiden\"),   resolution = 1,   n_neighbors = 50,   out_dir = NULL )"},{"path":"https://igordot.github.io/phenomenalist/reference/cluster.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform clustering — cluster","text":"x SpatialExperiment object. method Clustering method (`leiden` implemented currently). resolution Value parameter controlling coarseness clusters (higher resolution yields clusters). n_neighbors maximum number nearest neighbors compute. out_dir Name output analysis directory. specified, object corresponding plots saved .","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/cluster.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform clustering — cluster","text":"SpatialExperiment object.","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/create_object.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a SpatialExperiment object — create_object","title":"Create a SpatialExperiment object — create_object","text":"Create SpatialExperiment object (used manner SingleCellExperiment) store project data.","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/create_object.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a SpatialExperiment object — create_object","text":"","code":"create_object(   x,   expression_cols = NULL,   metadata_cols = NULL,   skip_cols = NULL,   clean_names = TRUE,   transformation = NULL,   out_dir = NULL )"},{"path":"https://igordot.github.io/phenomenalist/reference/create_object.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a SpatialExperiment object — create_object","text":"x data frame path file (can gzipped). expression_cols Column names markers/antibody expression vector grep pattern. Auto-detected specified. metadata_cols Column names cell metadata (markers/antibodies) vector grep pattern. Auto-detected specified. skip_cols Column names ignore (bad antibodies) vector grep pattern. clean_names logical scalar. Clean data frame column names remove problematic characters make unique. transformation character string indicating transformation method used. See transform(). out_dir Name output analysis directory. specified, object corresponding plots saved .","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/create_object.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a SpatialExperiment object — create_object","text":"SpatialExperiment object.","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/create_object.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a SpatialExperiment object — create_object","text":"","code":"tonsil_csv <- system.file(\"extdata\", \"tonsil-akoya-2018-500.csv\", package = \"phenomenalist\") tonsil_spe <- create_object(tonsil_csv, skip_cols = \"DAPI|Blank\", transformation = \"z\") #> number of input table rows: 500 #> number of input table columns: 42 #>  #> skipped columns: cyc001_ch001:DAPI1, cyc001_ch002:Blank, cyc001_ch003:Blank, cyc001_ch004:Blank, cyc002_ch001:DAPI2, cyc003_ch001:DAPI3, cyc004_ch001:DAPI4, cyc005_ch001:DAPI5, cyc006_ch001:DAPI6, cyc007_ch001:DAPI7, cyc008_ch001:DAPI8, cyc008_ch002:Blank, cyc008_ch003:Blank, cyc008_ch004:Blank #> number of expression columns: 18 #> number of metadata columns: 10 #>  #> expression columns: Actin, CD11c, CD14, CD15, CD20, CD21, CD3e, CD4, CD44, CD45, CD57, CD68, CD8, IDO1, Ki67, Pancytokeratin, SMA, Vimentin #> metadata columns: cell_id, reg, tile_num, x, y, z, x_tile, y_tile, size, homogeneity"},{"path":"https://igordot.github.io/phenomenalist/reference/detect_exprs_cols.html","id":null,"dir":"Reference","previous_headings":"","what":"Detect marker/antibody column names — detect_exprs_cols","title":"Detect marker/antibody column names — detect_exprs_cols","text":"input generally table expression values various metadata columns. function attempts determine columns contain expression values.","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/detect_exprs_cols.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Detect marker/antibody column names — detect_exprs_cols","text":"","code":"detect_exprs_cols(x)"},{"path":"https://igordot.github.io/phenomenalist/reference/detect_exprs_cols.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Detect marker/antibody column names — detect_exprs_cols","text":"x data frame.","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/detect_exprs_cols.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Detect marker/antibody column names — detect_exprs_cols","text":"vector column names.","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/plot_distribution.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot expression distribution — plot_distribution","title":"Plot expression distribution — plot_distribution","text":"Plot distribution expression intensities, split marker.","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/plot_distribution.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot expression distribution — plot_distribution","text":"","code":"plot_distribution(x, assay = \"exprs\", out_dir = NULL)"},{"path":"https://igordot.github.io/phenomenalist/reference/plot_distribution.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot expression distribution — plot_distribution","text":"x SpatialExperiment object. assay character string indicating values used. out_dir Name output analysis directory. specified, plots saved .","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/plot_distribution.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot expression distribution — plot_distribution","text":".","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/plot_dr.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot dimensionality reduction — plot_dr","title":"Plot dimensionality reduction — plot_dr","text":"Plot cell-level reduced dimension results stored SpatialExperiment object.","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/plot_dr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot dimensionality reduction — plot_dr","text":"","code":"plot_dr(   x,   dr,   color_by,   assay = \"logcounts\",   smooth = FALSE,   range = c(0.01, 0.99),   out_dir = NULL )"},{"path":"https://igordot.github.io/phenomenalist/reference/plot_dr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot dimensionality reduction — plot_dr","text":"x SpatialExperiment object. dr . color_by Column metadata field(s) feature(s) color . assay character string indicating expression values used. smooth logical scalar. Smooth values. Helps visualize expression patterns plot many overlapping points. range vector 2 values indicating minimum maximum percentiles color range. Helps visualize expression patterns extreme outliers present. example, c(0, 0.99) expand color scale 99th percentile. out_dir Name output analysis directory. specified, plots saved .","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/plot_dr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot dimensionality reduction — plot_dr","text":".","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/plot_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a heatmap — plot_heatmap","title":"Generate a heatmap — plot_heatmap","text":"Generate heatmap","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/plot_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a heatmap — plot_heatmap","text":"","code":"plot_heatmap(x, group_by, assay = \"logcounts\", out_dir = NULL)"},{"path":"https://igordot.github.io/phenomenalist/reference/plot_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a heatmap — plot_heatmap","text":"x SpatialExperiment object. group_by Column metadata field(s) group . assay character string indicating expression values used. out_dir Name output analysis directory. specified, plots saved .","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/plot_heatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a heatmap — plot_heatmap","text":"Heatmap object.","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/plot_scatter.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a generic scatter plot — plot_scatter","title":"Generate a generic scatter plot — plot_scatter","text":"Create scatter plot display relationship two continuous variables. essentially wrapper ggplot2::geom_point().","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/plot_scatter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a generic scatter plot — plot_scatter","text":"","code":"plot_scatter(   data,   x,   y,   color_by,   smooth = FALSE,   range = c(0.01, 0.99),   title = \"\",   aspect_ratio = 1 )"},{"path":"https://igordot.github.io/phenomenalist/reference/plot_scatter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a generic scatter plot — plot_scatter","text":"data data frame. x . y . color_by Column metadata field(s) feature(s) color . smooth logical scalar. Smooth values. Helps visualize expression patterns plot many overlapping points. range vector 2 values indicating minimum maximum percentiles color range. Helps visualize expression patterns extreme outliers present. example, c(0, 0.99) expand color scale 99th percentile. title Plot title. aspect_ratio Aspect ratio panel.","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/plot_scatter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a generic scatter plot — plot_scatter","text":"ggplot object.","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/plot_spatial.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot cells on their spatial coordinates — plot_spatial","title":"Plot cells on their spatial coordinates — plot_spatial","text":"Plot cell-level physical coordinates stored SpatialExperiment object.","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/plot_spatial.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot cells on their spatial coordinates — plot_spatial","text":"","code":"plot_spatial(   x,   color_by,   assay = \"logcounts\",   smooth = FALSE,   range = c(0.01, 0.99),   out_dir = NULL )"},{"path":"https://igordot.github.io/phenomenalist/reference/plot_spatial.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot cells on their spatial coordinates — plot_spatial","text":"x SpatialExperiment object. color_by Column metadata field(s) feature(s) color . assay character string indicating expression values used. smooth logical scalar. Smooth values. Helps visualize expression patterns plot many overlapping points. range vector 2 values indicating minimum maximum percentiles color range. Helps visualize expression patterns extreme outliers present. example, c(0, 0.99) expand color scale 99th percentile. out_dir Name output analysis directory. specified, plots saved .","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/plot_spatial.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot cells on their spatial coordinates — plot_spatial","text":".","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/run_umap.html","id":null,"dir":"Reference","previous_headings":"","what":"Run UMAP dimensionality reduction — run_umap","title":"Run UMAP dimensionality reduction — run_umap","text":"Run UMAP dimensionality reduction","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/run_umap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run UMAP dimensionality reduction — run_umap","text":"","code":"run_umap(   x,   assay = \"exprs\",   n_neighbors = 50,   min_dist = 0.01,   n_threads = NULL,   out_dir = NULL )"},{"path":"https://igordot.github.io/phenomenalist/reference/run_umap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run UMAP dimensionality reduction — run_umap","text":"x SpatialExperiment object. assay . n_neighbors size local neighborhood (terms number neighboring sample points) used manifold approximation. Larger values result global views manifold, smaller values result local data preserved. general values range 2 100. min_dist effective minimum distance embedded points. Smaller values result clustered/clumped embedding nearby points manifold drawn closer together, larger values result even dispersal points. value set relative spread value, determines scale embedded points spread . n_threads Number threads use (except stochastic gradient descent). Default half number concurrent threads supported system. nearest neighbor search, applies nn_method = \"annoy\". n_threads > 1, Annoy index temporarily written disk location determined tempfile. out_dir Name output analysis directory. specified, object saved .","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/run_umap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run UMAP dimensionality reduction — run_umap","text":"SpatialExperiment object.","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/tidyeval.html","id":null,"dir":"Reference","previous_headings":"","what":"Tidy eval helpers — tidyeval","title":"Tidy eval helpers — tidyeval","text":"page lists tidy eval tools reexported package rlang. learn using tidy eval scripts packages high level, see dplyr programming vignette ggplot2 packages vignette. Metaprogramming section Advanced R may also useful deeper dive. tidy eval operators {{, !!, !!! syntactic constructs specially interpreted tidy eval functions. mostly need {{, !! !!! advanced operators use simple cases. curly-curly operator {{ allows tunnel data-variables passed function arguments inside tidy eval functions. {{ designed individual arguments. pass multiple arguments contained dots, use ... normal way.   enquo() enquos() delay execution one several function arguments. former returns single expression, latter returns list expressions. defused, expressions longer evaluate . must injected back evaluation context !! (single expression) !!! (list expressions).   simple case, code equivalent usage {{ ... . Defusing enquo() enquos() needed complex cases, instance need inspect modify expressions way. .data pronoun object represents current slice data. variable name string, use .data pronoun subset variable [[.   Another tidy eval operator :=. makes possible use glue curly-curly syntax LHS =. technical reasons, R language support complex expressions left =, use := workaround.   Many tidy eval functions like dplyr::mutate() dplyr::summarise() give automatic name unnamed inputs. need create sort automatic names , use as_label(). instance, glue-tunnelling syntax can reproduced manually :   Expressions defused enquo() (tunnelled {{) need simple column names, can arbitrarily complex. as_label() handles cases gracefully. code assumes simple column name, use as_name() instead. safer throws error input name expected.","code":"my_function <- function(data, var, ...) {   data %>%     group_by(...) %>%     summarise(mean = mean({{ var }})) } my_function <- function(data, var, ...) {   # Defuse   var <- enquo(var)   dots <- enquos(...)    # Inject   data %>%     group_by(!!!dots) %>%     summarise(mean = mean(!!var)) } my_var <- \"disp\" mtcars %>% summarise(mean = mean(.data[[my_var]])) my_function <- function(data, var, suffix = \"foo\") {   # Use `{{` to tunnel function arguments and the usual glue   # operator `{` to interpolate plain strings.   data %>%     summarise(\"{{ var }}_mean_{suffix}\" := mean({{ var }})) } my_function <- function(data, var, suffix = \"foo\") {   var <- enquo(var)   prefix <- as_label(var)   data %>%     summarise(\"{prefix}_mean_{suffix}\" := mean(!!var)) }"},{"path":"https://igordot.github.io/phenomenalist/reference/transform.html","id":null,"dir":"Reference","previous_headings":"","what":"Transform/normalize expression data — transform","title":"Transform/normalize expression data — transform","text":"Transform/normalize expression data. options currently: log: log10 + 1 z: Z normalization marker (recommended Hickey et al.)","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/transform.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transform/normalize expression data — transform","text":"","code":"transform(x, method = c(\"log\", \"z\"), out_dir = NULL)"},{"path":"https://igordot.github.io/phenomenalist/reference/transform.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transform/normalize expression data — transform","text":"x SpatialExperiment object. method character string indicating transformation method used. out_dir Name output directory. specified, density plots saved .","code":""},{"path":"https://igordot.github.io/phenomenalist/reference/transform.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transform/normalize expression data — transform","text":"SpatialExperiment object transformed values exprs assay.","code":""}]
